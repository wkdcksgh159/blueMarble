<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>sample</title>
<style>
   td{
      font-size:9px;
      width: 150px;
       height: 80px;
       text-align:center;
   }
   .gold {
      font-size:20px;
      font-type:bold;
   }
   #dialog {
   	  display:none;
   }
   .placePoint {
      display:none;
   }
   #sellSpan {
		display:inline-block;
		font-size:20px;
      	width: 180px;
		text-align:center;
		border:1px solid;
	}
</style>
</head>
<link rel="stylesheet" href="/BlueMarble/css/jquery-ui.css">
<script src="/BlueMarble/script/jquery-3.4.1.min.js"></script>
<script src="/BlueMarble/script/jquery-ui.js"></script>
<script src="/BlueMarble/script/player.js"></script>
<script src="/BlueMarble/script/city.js"></script>
<script src="/BlueMarble/script/function3.js"></script>
<script src="/BlueMarble/script/goldenkey.js"></script>
<body>
<h3>
   부르마블
   <button type="button" id="diceBtn">King Dice!</button>
   현재 플레이어 : <input type="text" id="player" value="">
   주사위 값 : <input type="text" id="diceValue" value="">
   이동지점 : <input type="text" id="point" value="">
</h3>
<div id="allPlayer">
</div>
<table border="1">
   <tr>
   	  <!-- 나라태그, player:땅의 주인을 확인하는 클래스, city:도시의 이름을 확인하는 클래스, gold:도시의 가격을 확인하는 클래스 주인이없으면 땅값이 출력 -->
      <td id="p1" class="place"><div class="placePoint">1</div><div class="player2">0</div>Start<div class="gold">1</div><div id="btn"></div></td>
      <td id="p2" class="place"><div class="placePoint">2</div><div class="player">0</div><div class="city">타이페이</div><div class="gold">50000</div></td>
      <td id="p3" class="place"><div class="placePoint">3</div><div class="player2">0</div><div class="event">황금열쇠</div><div class="gold">3</div></td>
      <td id="p4" class="place"><div class="placePoint">4</div><div class="player">0</div><div class="city">베이징</div><div class="gold">80000</div></td>
      <td id="p5" class="place"><div class="placePoint">5</div><div class="player">0</div><div class="city">마닐라</div><div class="gold">80000</div></td>
      <td id="p6" class="place"><div class="placePoint">6</div><div class="player">0</div><div class="city">제주도</div><div class="gold">200000</div></td>
      <td id="p7" class="place"><div class="placePoint">7</div><div class="player">0</div><div class="city">싱가포르</div><div class="gold">100000</div></td>
      <td id="p8" class="place"><div class="placePoint">8</div><div class="player2">0</div><div class="event">황금열쇠</div><div class="gold">8</div></td>
      <td id="p9" class="place"><div class="placePoint">9</div><div class="player">0</div><div class="city">카이로</div><div class="gold">100000</div></td>
      <td id="p10" class="place"><div class="placePoint">10</div><div class="player">0</div><div class="city">이스탄불</div><div class="gold">120000</div></td>
      <td id="p11" class="place"><div class="placePoint">11</div><div class="player2">0</div><div class="event">무인도</div><div class="gold">11</div></td>
   </tr>
   <tr>
      <td id="p40" class="place"><div class="placePoint">40</div><div class="player">0</div><div class="city">서울</div><div class="gold">1000000</div></td>
      <td rowspan="9" colspan="9"><span id="center"></span></td>
      <td id="p12" class="place"><div class="placePoint">12</div><div class="player">0</div><div class="city">아테네</div><div class="gold">140000</div></td>
   </tr>
   <tr>
      <td id="p39" class="place"><div class="placePoint">39</div><div class="player2">0</div><div class="event">사회복지기금(내는곳)</div><div class="gold">150000</div></td>
      
      <td id="p13" class="place"><div class="placePoint">13</div><div class="player2">0</div><div class="event">황금열쇠</div><div class="gold">13</div></td>
   </tr>
   <tr>
      <td id="p38" class="place"><div class="placePoint">38</div><div class="player">0</div><div class="city">뉴욕</div><div class="gold">350000</div></td>
      
      <td id="p14" class="place"><div class="placePoint">14</div><div class="player">0</div><div class="city">코펜하겐</div><div class="gold">160000</div></td>
   </tr>
   <tr>
      <td id="p37" class="place"><div class="placePoint">37</div><div class="player">0</div><div class="city">런던</div><div class="gold">350000</div></td>
      
      <td id="p15" class="place"><div class="placePoint">15</div><div class="player">0</div><div class="city">스톡홀름</div><div class="gold">160000</div></td>
   </tr>
   <tr>
      <td id="p36" class="place"><div class="placePoint">36</div><div class="player2">0</div><div class="event">황금열쇠</div><div class="gold">36</div></td>
      
      <td id="p16" class="place"><div class="placePoint">16</div><div class="player">0</div><div class="city">콩코드여객기</div><div class="gold">200000</div></td>
   </tr>
   <tr>
      <td id="p35" class="place"><div class="placePoint">35</div><div class="player">0</div><div class="city">로마</div><div class="gold">320000</div></td>
      
      <td id="p17" class="place"><div class="placePoint">17</div><div class="player">0</div><div class="city">베른</div><div class="gold">180000</div></td>
   </tr>
   <tr>
      <td id="p34" class="place"><div class="placePoint">34</div><div class="player">0</div><div class="city">파리</div><div class="gold">320000</div></td>
      
      <td id="p18" class="place"><div class="placePoint">18</div><div class="player2">0</div><div class="event">황금열쇠</div><div class="gold">18</div></td>
   </tr>
   <tr>
      <td id="p33" class="place"><div class="placePoint">33</div><div class="player">0</div><div class="city">콜럼비아호</div><div class="gold">450000</div></td>
      
      <td id="p19" class="place"><div class="placePoint">19</div><div class="player">0</div><div class="city">베를린</div><div class="gold">180000</div></td>
   </tr>
   <tr>
      <td id="p32" class="place"><div class="placePoint">32</div><div class="player">0</div><div class="city">도쿄</div><div class="gold">300000</div></td>
      
      <td id="p20" class="place"><div class="placePoint">20</div><div class="player">0</div><div class="city">오타와</div><div class="gold">200000</div></td>
   </tr>
   <tr>
      <td id="p31" class="place"><div class="placePoint">31</div><div class="player2">0</div><div class="event">우주여행</div><div class="gold">31</div></td>
      <td id="p30" class="place"><div class="placePoint">30</div><div class="player">0</div><div class="city">마드리드</div><div class="gold">280000</div></td>
      <td id="p29" class="place"><div class="placePoint">29</div><div class="player">0</div><div class="city">퀸엘리자베스호</div><div class="gold">300000</div></td>
      <td id="p28" class="place"><div class="placePoint">28</div><div class="player">0</div><div class="city">리스본</div><div class="gold">260000</div></td>
      <td id="p27" class="place"><div class="placePoint">27</div><div class="player">0</div><div class="city">하와이</div><div class="gold">260000</div></td>
      <td id="p26" class="place"><div class="placePoint">26</div><div class="player">0</div><div class="city">부산</div><div class="gold">500000</div></td>
      <td id="p25" class="place"><div class="placePoint">25</div><div class="player">0</div><div class="city">시드니</div><div class="gold">240000</div></td>
      <td id="p24" class="place"><div class="placePoint">24</div><div class="player">0</div><div class="city">상파울로</div><div class="gold">240000</div></td>
      <td id="p23" class="place"><div class="placePoint">23</div><div class="player2">0</div><div class="event">황금열쇠</div><div class="gold">23</div></td>
      <td id="p22" class="place"><div class="placePoint">22</div><div class="player">0</div><div class="city">부에노스아이레스</div><div class="gold">220000</div></td>
      <td id="p21" class="place"><div class="placePoint">21</div><div class="player2">0</div><div class="event">사회복지기금(받는곳)</div><div class="gold">21</div></td>
   </tr>
</table>
<!-- dialog태그 넣는곳 -->
<div id="dialogTag">
</div>
<div id="sellBuild" title="판매할 도시">
</div>
<!-- 
<div id="dialog" title='도시이름'>
	<div id='landDiv'>대지 <input type='radio' name='build' id='land' checked='checked'><span id='landToll'></span></div>
	<div id='villaDiv'>별장 <input type='radio' name='build' id='villa'><span id='villaToll'></span></div>
	<div id='buildingDiv'>빌딩 <input type='radio' name='build' id='building'><span id='buildingToll'></span></div>
	<div id='hotelDiv'>호텔 <input type='radio' name='build' id='hotel'><span id='hotelToll'></span></div>
	<button type='button' id='buy'>구매</button>
	<button type='button' id='cancel'>취소</button></div>
 -->	
</body>
<script>
   $(document).ready(function(){
	 //플레이어 초기화
      let player = 0;
	  $("#diceBtn").attr("disabled", true);
	  //인원수 파악
	  start = false;
	  let allPlayer = "";
	  while(start == false) {
		  allPlayer = prompt("몇명이서 플레이합니까? (1~4까지의 숫자만 입력가능)");
		  if(allPlayer > 1 && allPlayer < 5){
			  alert("게임시작")
			  $("#diceBtn").attr("disabled", false);
			  start = true;
		  } else {
			  alert("다시입력")
			  start = false;
		  }
	  }
	  //유저 세팅
	  gamer = [Player1, Player2, Player3, Player4];
	  console.log("최대 유저 : ", allPlayer);
	  gamer = gamer.slice(0, allPlayer);
	  console.log("현재 유저 : ", gamer);
	  
	  //플레이어 수 만큼 돈, 이미지 세팅
	  for(i=1; i <= allPlayer; i++){
		  let playerMoneyHtml = "플레이어"+i+" 돈 : <input type='text' id='player"+i+"money' value='3000000'>";
		  $("#allPlayer").append(playerMoneyHtml);
	  }
	  for(i=1; i <= allPlayer; i++){
		  let playerHtml = "<img class='btn-danger"+i+"' src='/jquery-prac/image/pic0"+i+".jpg'>";
		  $("#btn").append(playerHtml);
	  }
	  
      
      //주사위 클릭시
      $("#diceBtn").click(function(){
    	console.log("주사위 눌렀을때 player : ", player);
    	currentGamer = gamer[player];
    	console.log("currentGamer : ", currentGamer);
    	//테이블 클릭잠금
    	$(".place").off("click");
      	//$(".place").attr("disabled", true);
    	 //주사위 세팅(1~6까지 숫자 랜덤)
         let ran1 = Math.floor(Math.random()*6+1);
    	 console.log("ran1 : ", ran1);
         let ran2 = Math.floor(Math.random()*6+1);
         console.log("ran2 : ", ran2);
         ran = 2;//ran1+ran2;
         $("#diceValue").val(ran);
    	 $("#player").val(player);
         console.log("currentGamer : ",currentGamer);
            //주사위를 굴렸을때 이동지점
            if(currentGamer.beforePoint+ran < 41){
            	currentGamer.afterPoint = currentGamer.beforePoint+ran;
            } else {
            	currentGamer.afterPoint = currentGamer.beforePoint+ran-40;
            	currentGamer.money += 200000;
            	$("#player"+currentGamer.player+"money").val(currentGamer.money);
            }
            //이동지점 내용 입력
            $("#point").val(currentGamer.afterPoint);
            console.log("currentGamer.round : ", currentGamer.round);
          	//이동한 지점에 유저 버튼 생성
            let html = "<img class='btn-danger"+currentGamer.player+"' src='/jquery-prac/image/pic0"+currentGamer.player+".jpg'>";
            currentGamer.beforeId = "#p"+currentGamer.beforePoint;
            currentGamer.afterId = "#p"+currentGamer.afterPoint;
            console.log("currentGamer.afterId : ", currentGamer.afterId);
            
            //현재위치가 무인도일때
            if(currentGamer.beforePoint == 11){
            	alert("세턴동안 무인도에 갇혀있습니다 현재 "+currentGamer.round+"턴째");
            	currentGamer.round = island(currentGamer, ran1, ran2);
            }
          	//현재위치가 우주여행일때
            if(currentGamer.beforePoint == 31){
            	//주사위 버튼 잠금
            	$("#diceBtn").attr("disabled", true);
            	console.log("우주여행 시작!");
            	alert("우주여행 시작!");
            	$(".place").on("click", function(){
            		console.log("우주여행 클릭!");
            		currentGamer.beforeId = "#p" + currentGamer.beforePoint;
            		console.log("우주여행 currentGamer.beforePoint", currentGamer.beforePoint);
            		currentGamer.afterPoint = $(this).find(".placePoint").text();
            		if(currentGamer.afterPoint < 31){
            			currentGamer.money += 200000;
                    	$("#player"+currentGamer.player+"money").val(currentGamer.money);
            		}
            		currentGamer.afterId = "#p" + currentGamer.afterPoint;
            		console.log("우주여행 currentGamer.afterPoint", currentGamer.afterPoint);
            		$(currentGamer.beforeId).find(".btn-danger"+currentGamer.player).remove();
            		$(this).append("<img class='btn-danger"+currentGamer.player+"' src='/jquery-prac/image/pic0"+currentGamer.player+".jpg'>");
            		currentGamer.beforePoint = parseInt(currentGamer.afterPoint);
            		currentGamer.round = 0;
            		//땅을 구매하거나 통행료를 지불하는 함수
            		pay(currentGamer);
            		//테이블 클릭잠금
                	$(".place").off("click");
                	//주사위 버튼 잠금 해제
                	$("#diceBtn").attr("disabled", false);
            	});
            }
            //round 체크
            if(currentGamer.round == 0){
            	//위치 이동
            	$(currentGamer.beforeId).find(".btn-danger"+currentGamer.player).remove();
                $(currentGamer.afterId).append(html);
              	//이동위치를 현재위치로 변경
                currentGamer.beforePoint = currentGamer.afterPoint;
            } else {
               	//위치 그대로
               	console.log("round currentGamer.beforePoint", currentGamer.beforePoint);
               	currentGamer.afterId = currentGamer.beforeId;
            }
            //땅을 구매하거나 통행료를 지불하는 함수
            gamer = pay(currentGamer);
            
          	//더블을 확인하는 함수
            player = doubleDice(ran1, ran2, player, gamer);
            console.log("-----------------------");
      });
      
      $("#goldenKey").click(function(){
    	   
      });
      
   });
</script>
</html>